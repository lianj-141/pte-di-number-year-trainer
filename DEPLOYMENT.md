# éƒ¨ç½²æŒ‡å—ï¼ˆCloudflare Workersï¼‰

æœ¬é¡¹ç›®å·²ç²¾ç®€ä¸ºâ€œå• Worker åº”ç”¨â€ã€‚ä¸å†ä½¿ç”¨ Cloudflare Pages æˆ– Pages Functionsï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½åœ¨ `worker.js` ä¸­ï¼š

- `GET /` è¿”å›å®Œæ•´é¡µé¢ï¼ˆå†…åµŒ HTML/CSS/JSï¼‰
- `POST /api/tts` ä»£ç†è…¾è®¯äº‘ TTS å¹¶è¿”å› MP3

ä¸‹é¢æä¾›ä¸¤ç§éƒ¨ç½²æ–¹å¼ï¼šWeb æ§åˆ¶å°å’Œå‘½ä»¤è¡Œã€‚

## ğŸŒŸ ä½¿ç”¨ Cloudflare ç½‘é¡µæ§åˆ¶å°

### æ­¥éª¤ 1ï¼šæ³¨å†Œ Cloudflare è´¦å·
1. è®¿é—® [https://dash.cloudflare.com/sign-up](https://dash.cloudflare.com/sign-up)
2. æ³¨å†Œä¸€ä¸ªå…è´¹è´¦å·å¹¶éªŒè¯é‚®ç®±

### æ­¥éª¤ 2ï¼šè·å–è…¾è®¯äº‘ TTS å‡­è¯
1. ç™»å½• [è…¾è®¯äº‘æ§åˆ¶å°](https://console.cloud.tencent.com/)
2. å¼€é€š**è¯­éŸ³åˆæˆï¼ˆTTSï¼‰**æœåŠ¡
3. åœ¨ [è®¿é—®ç®¡ç† - APIå¯†é’¥ç®¡ç†](https://console.cloud.tencent.com/cam/capi) ä¸­è·å–ï¼š
   - `SecretId`ï¼ˆç±»ä¼¼ï¼šAKIDxxxxxï¼‰
   - `SecretKey`ï¼ˆç±»ä¼¼ï¼šxxxxxï¼‰

### æ­¥éª¤ 3ï¼šåˆ›å»º Workerï¼ˆç½‘é¡µæ“ä½œï¼‰

#### 3.1 è¿›å…¥ Workers æ§åˆ¶å°
1. ç™»å½• Cloudflare åï¼Œç‚¹å‡»å·¦ä¾§çš„ **"Workers & Pages"**
2. ç‚¹å‡» **"Create application"**
3. é€‰æ‹© **"Create Worker"**ï¼ˆé Pagesï¼‰
4. ç»™ Worker èµ·ä¸ªåå­—ï¼Œæ¯”å¦‚ `pte-trainer`
5. ç‚¹å‡» **"Deploy"**

#### 3.2 ä¸Šä¼ ä»£ç 
1. éƒ¨ç½²åä¼šè¿›å…¥ä»£ç ç¼–è¾‘ç•Œé¢
2. **åˆ é™¤**é»˜è®¤çš„æ‰€æœ‰ä»£ç 
3. æ‰“å¼€é¡¹ç›®ä¸­çš„ `worker.js` æ–‡ä»¶
4. **å¤åˆ¶å…¨éƒ¨å†…å®¹**ç²˜è´´åˆ°ç¼–è¾‘å™¨ä¸­
5. ç‚¹å‡»å³ä¸Šè§’ **"Save and deploy"**

### æ­¥éª¤ 4ï¼šè®¾ç½®ç¯å¢ƒå˜é‡ï¼ˆSecretsï¼‰
1. åœ¨ Worker é¡µé¢ï¼Œç‚¹å‡» **"Settings"** æ ‡ç­¾
2. æ‰¾åˆ° **"Environment Variables"** éƒ¨åˆ†
3. ç‚¹å‡» **"Add variable"** æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

**æ·»åŠ ç¬¬ä¸€ä¸ªå˜é‡ï¼š**
- Variable name: `TENCENT_SECRET_ID`
- Value: `ä½ çš„è…¾è®¯äº‘ SecretId`
- Type: **é€‰æ‹© "Secret"**ï¼ˆé‡è¦ï¼ï¼‰
- ç‚¹å‡» **"Save"**

**æ·»åŠ ç¬¬äºŒä¸ªå˜é‡ï¼š**
- Variable name: `TENCENT_SECRET_KEY`  
- Value: `ä½ çš„è…¾è®¯äº‘ SecretKey`
- Type: **é€‰æ‹© "Secret"**ï¼ˆé‡è¦ï¼ï¼‰
- ç‚¹å‡» **"Save"**

å¯é€‰ï¼š
- Variable name: `TENCENT_REGION`
- Value: `ap-guangzhou`
- Type: é€‰æ‹© "Text"
- ç‚¹å‡» **"Save"**

### æ­¥éª¤ 5ï¼šæµ‹è¯•è®¿é—®
1. å›åˆ° Worker çš„ **"Deployments"** é¡µé¢
2. æ‰¾åˆ°ä½ çš„ Worker URLï¼ˆç±»ä¼¼ï¼š`https://pte-trainer.ä½ çš„ç”¨æˆ·å.workers.dev`ï¼‰
3. ç‚¹å‡»é“¾æ¥è®¿é—®ä½ çš„åº”ç”¨ï¼

---

## ğŸ› ï¸ å‘½ä»¤è¡Œéƒ¨ç½²ï¼ˆwranglerï¼‰

å¦‚æœä½ ç†Ÿæ‚‰å‘½ä»¤è¡Œï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ wrangler å·¥å…·ï¼š

### å®‰è£… wrangler
éœ€è¦å…ˆå®‰è£… Node.jsï¼Œç„¶åï¼š
```bash
npm install -g wrangler
```

### ç™»å½•å’Œéƒ¨ç½²
```bash
# ç™»å½•ï¼ˆä¼šæ‰“å¼€æµè§ˆå™¨éªŒè¯ï¼‰
wrangler login

# è¿›å…¥é¡¹ç›®ç›®å½•å¹¶è®¾ç½®å¯†é’¥ï¼ˆæœ¬åœ°/è¿œç«¯ï¼‰
cd pte-di-number-year-trainer
wrangler secret put TENCENT_SECRET_ID
wrangler secret put TENCENT_SECRET_KEY

# éƒ¨ç½²
wrangler deploy
```

---

## ğŸ“ éƒ¨ç½²åçš„ URL
éƒ¨ç½²æˆåŠŸåï¼Œä½ ä¼šå¾—åˆ°ä¸€ä¸ªç½‘å€ï¼Œæ ¼å¼ç±»ä¼¼ï¼š
```
https://pte-trainer.ä½ çš„ç”¨æˆ·å.workers.dev
```

## âœ… åŠŸèƒ½æ£€æŸ¥æ¸…å•
è®¿é—®ä½ çš„ç½‘ç«™åï¼Œæ£€æŸ¥ä»¥ä¸‹åŠŸèƒ½ï¼š
- [ ] é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] å¯ä»¥ç”Ÿæˆæ•°å­—/å¹´ä»½
- [ ] æ˜¾ç¤º/éšè—è¯»æ³•åŠŸèƒ½æ­£å¸¸
- [ ] é”®ç›˜å¿«æ·é”®å·¥ä½œæ­£å¸¸
- [ ] **æ’­æ”¾å‘éŸ³**æŒ‰é’®æœ‰å£°éŸ³ï¼ˆè¿™ä¸ªéœ€è¦è…¾è®¯äº‘é…ç½®æ­£ç¡®ï¼‰

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: æ’­æ”¾å‘éŸ³æ²¡æœ‰å£°éŸ³ï¼Ÿ
A: æ£€æŸ¥ä»¥ä¸‹å‡ ç‚¹ï¼š
1. è…¾è®¯äº‘ TTS æœåŠ¡æ˜¯å¦å·²å¼€é€š
2. SecretId å’Œ SecretKey æ˜¯å¦æ­£ç¡®
3. ç¯å¢ƒå˜é‡ç±»å‹æ˜¯å¦è®¾ç½®ä¸º "Secret"

### Q: ç½‘ç«™æ‰“ä¸å¼€ï¼Ÿ
A: 
1. ç¡®è®¤ Worker å·²æˆåŠŸéƒ¨ç½²
2. æ£€æŸ¥ worker.js ä»£ç æ˜¯å¦å®Œæ•´å¤åˆ¶
3. æŸ¥çœ‹ Cloudflare æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯

### Q: å¦‚ä½•æ›´æ–°ä»£ç ï¼Ÿ
A: 
1. ä¿®æ”¹ GitHub ä¸Šçš„ worker.js
2. å¤åˆ¶æ–°ä»£ç åˆ° Cloudflare Workers ç¼–è¾‘å™¨
3. ç‚¹å‡» "Save and deploy"

### Q: æƒ³è¦è‡ªå®šä¹‰åŸŸåï¼Ÿ
A: 
1. åœ¨ Worker é¡µé¢ç‚¹å‡» "Triggers" æ ‡ç­¾
2. ç‚¹å‡» "Add Custom Domain"  
3. è¾“å…¥ä½ çš„åŸŸåï¼ˆéœ€è¦å…ˆåœ¨ Cloudflare æ‰˜ç®¡è¯¥åŸŸåï¼‰

## ğŸ’° è´¹ç”¨è¯´æ˜
- Cloudflare Workers å…è´¹å¥—é¤ï¼šæ¯å¤© 100,000 æ¬¡è¯·æ±‚
- è…¾è®¯äº‘ TTSï¼šå‰ 10,000 å­—ç¬¦å…è´¹ï¼Œä¹‹åæŒ‰é‡è®¡è´¹
- ä¸ªäººå­¦ä¹ ä½¿ç”¨å®Œå…¨å…è´¹ï¼

## ğŸ¯ æ¨èçš„éƒ¨ç½²æ–¹å¼
å¯¹äºå¤§å¤šæ•°ç”¨æˆ·ï¼Œ**å»ºè®®ä½¿ç”¨ç½‘é¡µæ§åˆ¶å°éƒ¨ç½²**ï¼Œç®€å•ç›´è§‚ï¼Œæ— éœ€å®‰è£…é¢å¤–è½¯ä»¶ã€‚
